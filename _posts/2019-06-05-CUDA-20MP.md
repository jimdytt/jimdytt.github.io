---
layout: post
date: 2019-06-05 10:00
title: "Core disparity algorithm working and CUDA performance"
author: jim
category:

tags:
- home1

---

![Stereo Depth]({{ site.url}}/assets/content_img/colour_depth_roofs_integer_med.jpg)

First three months of 2019 were spent improving the core stereo photogrammetry disparity algorithm. This consisted of a major overhaul changing from a per block algorithm to per pixel algo. This is working in Matlab and an example of a disparity map is above. The image is false coloured so each colour change reflects a 1 pixel disparity change between the stereo pair.

The image shows a distance to a near shed roof of approx 35-40m and the large building in the background is approx 150m away and I have tested out to 800m.  Pixel accuracy is approximately 1/4 pel.

The last two months have been moving to a new image platform - a pair of  Hikvision 20MP colour camera using the SONY IMX183.
I've also been porting the Matlab code to CUDA and early results give a full 20MP depth image within a few seconds.

If we look below we can see the 3D view of the scene from Google ( Their photogrammetry is pretty amazing)

![Google view]({{ site.url}}/assets/content_img/goog_jpg.jpg)

Then below is an early version of the CUDA 20MP image - still a bit noisy, but note the church spire in red which is 800m away and at 2-3 pixels of disparity. 

![Cuda image   - Reduced size]({{ site.url}}/assets/content_img/col_depth_cuda_small.jpg)

[Click here to see the full 20MP image]({{ site.url}}/assets/content_img/col_depth_cuda.jpg) and note detail like television aerials etc.

Next steps are to move the algorithm to consider previous frames, with a target framerate between 2-6fps.

Please email me jimd -at- yantantethera.com if you have any questions.
